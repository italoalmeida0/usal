var USAL=(()=>{var $=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var R=(A,h)=>{for(var C in h)$(A,C,{get:h[C],enumerable:!0})},U=(A,h,C,D)=>{if(h&&typeof h=="object"||typeof h=="function")for(let p of B(h))!H.call(A,p)&&p!==C&&$(A,p,{get:()=>h[p],enumerable:!(D=z(h,p))||D.enumerable});return A};var V=A=>U($({},"__esModule",{value:!0}),A);var Y={};R(Y,{default:()=>X});var M=(()=>{let A={observer:null,mutationObserver:null,elements:new Map,animating:new Set,config:{maxConcurrent:100,defaultDuration:1e3,defaultDelay:0,defaultThreshold:30,defaultSplitDelay:30}},h=(e,n)=>{let t=e.trim().split(/\s+/),s={animation:"fade",direction:"",duration:n.config.defaultDuration,delay:n.config.defaultDelay,threshold:n.config.defaultThreshold,splitDelay:n.config.defaultSplitDelay,easing:"ease-out",blur:!1,once:!1,split:null,splitAnimation:null,count:null,text:null};return t.forEach(o=>{let a=o.split("-"),i=a[0],r=a[1];if(["fade","zoomin","zoomout","flip"].includes(i)){if(s.animation=i,r){let l={u:"up",d:"down",l:"left",r:"right"};s.direction=r.split("").map(d=>l[d]).join("-")}}else i==="split"?["word","letter","item"].includes(r)?s.split=r:r==="delay"&&a[2]?s.splitDelay=parseInt(a[2]):s.splitAnimation=a.slice(1).join("-"):i==="text"&&["shimmer","fluid"].includes(r)?s.text=r:o.startsWith("count-[")&&o.endsWith("]")?s.count=o.slice(7,-1):r&&!isNaN(parseInt(r))?i==="duration"?s.duration=parseInt(r):i==="delay"?s.delay=parseInt(r):i==="threshold"&&(s.threshold=parseInt(r)):o==="blur"?s.blur=!0:o==="once"?s.once=!0:["linear","ease","ease-in","ease-out"].includes(o)&&(s.easing=o)}),s},C={linear:e=>e,ease:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,"ease-in":e=>e*e*e,"ease-out":e=>1-Math.pow(1-e,3)},D=(e,n,t)=>{let s=t,o=1-s,a=d=>{if(!n)return d==="flip"?`rotateY(${o*90}deg)`:"";let c=o*(d==="flip"&&n.length>1?45:d==="flip"?90:30);if(d==="flip"){let m=n.includes("u")?c:n.includes("d")?-c:0,u=n.includes("l")?-c:n.includes("r")?c:0;return[m&&`rotateX(${m}deg)`,u&&`rotateY(${u}deg)`].filter(Boolean).join(" ")}let f=n.includes("r")?-c:n.includes("l")?c:0,y=n.includes("d")?-c:n.includes("u")?c:0;return f||y?`translate(${f}px, ${y}px)`:""},i={fade:"",zoomin:`scale(${.6+s*.4})`,zoomout:`scale(${1.2-s*.2})`,flip:`perspective(400px) ${a("flip")}`}[e]||"",r=e!=="flip"?a("offset"):"",l=[i,r].filter(Boolean).join(" ")||"none";return[s,l]},p=(e,n)=>Object.assign(e.style,n),N=e=>{let n=e.getBoundingClientRect();return n.top<window.innerHeight&&n.bottom>0},P=(e,n)=>{let t=e.getAttribute("data-usal-id");t||(t=`usal-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,e.setAttribute("data-usal-id",t));let s=e.getAttribute("data-usal")||"",o=h(s,n),a={element:e,config:o,configString:s,original:["opacity","transform","filter"].reduce((i,r)=>({...i,[r]:e.style[r]||""}),{}),targets:null,animated:!1,rafId:null};if(o.count){let r=e.textContent.split(o.count);if(r.length===2){let l=o.count.trim();l=l.replace(/[^\d\s,.]/g,"");let d=0,c=0,f=l.includes(","),y=l.includes("."),m=l.includes(" "),u=[f,y,m].filter(Boolean).length;if(u>=2){let b=l.lastIndexOf(","),x=l.lastIndexOf("."),v=b>x?b:x,w=l.substring(0,v),I=l.substring(v+1).replace(/\D/g,"");d=I.length;let E=w.replace(/\D/g,"");c=parseFloat(E+"."+I)}else if(u===1&&(f||y)){let b=f?l.lastIndexOf(","):l.lastIndexOf("."),x=l.substring(b+1);if(x.length<=2&&/^\d+$/.test(x)){let v=l.substring(0,b);d=x.length,c=parseFloat(v.replace(/\D/g,"")+"."+x)}else c=parseFloat(l.replace(/\D/g,"")),d=0}else c=parseFloat(l.replace(/\D/g,"")),d=0;a.countData={value:c,decimals:d,original:o.count,before:r[0],after:r[1]},e.textContent="",e.appendChild(document.createTextNode(r[0]));let g=document.createElement("span");g.textContent="0",e.appendChild(g),e.appendChild(document.createTextNode(r[1])),a.countSpan=g}}if(o.split){let i=[];if(o.split==="item")Array.from(e.children).forEach(r=>{r.style.opacity="0",o.text&&(r.style.opacity="1"),i.push(r)});else{let r=o.split==="word",l=document.createElement("div");l.innerHTML=e.innerHTML;let d=document.createTreeWalker(l,NodeFilter.SHOW_TEXT),c=[];for(;d.nextNode();)c.push({text:d.currentNode.textContent,parent:d.currentNode.parentNode});e.innerHTML="",c.forEach(({text:f})=>{if(!f.trim()){e.appendChild(document.createTextNode(f));return}(r?f.split(/(\s+)/):f.split("")).forEach(m=>{if(m)if(/\s/.test(m))e.appendChild(document.createTextNode(m));else{let u=document.createElement("span");u.textContent=m,u.style.display="inline-block",u.style.opacity="0",o.text&&(u.style.opacity="1"),e.appendChild(u),i.push(u)}})})}a.targets=i,o.splitAnimation&&(a.splitAnimationParsed=h(o.splitAnimation,n))}if(!o.text&&!a.countSpan&&!a.targets){let[i,r]=D(o.animation,o.direction,0);p(e,{opacity:i,transform:r!=="none"?r:"",filter:o.blur?"blur(10px)":""})}return n.elements.set(t,a),a},q=(e,n,t)=>{let s=n.includes(","),o=n.includes("."),a=n.includes(" "),i=t>0?e.toFixed(t):Math.floor(e).toString();if(a||s&&!o||o&&!s){let r=i.split("."),l=a?" ":s?",":".";r[0]=r[0].replace(/\B(?=(\d{3})+(?!\d))/g,l),i=r.join(t>0?s?",":".":"")}return i},O=(e,n)=>{if(e.animated&&e.config.once||n.animating.has(e.element)||n.animating.size>=n.config.maxConcurrent)return;n.animating.add(e.element);let{config:t,element:s,targets:o,countSpan:a,countData:i}=e,r=performance.now()+t.delay,l=C[t.easing],d=t;if(o&&t.splitAnimation&&(d=h(t.splitAnimation,n)),t.text){let f=o||[s],y=performance.now(),m=()=>{let g=(performance.now()-y)%t.duration/t.duration;f.forEach((b,x)=>{if(t.text==="shimmer"){let v=g*Math.PI*2+x*.5,w=Math.sin(v)*.5+.5;p(b,{opacity:.5+w*.5,filter:`brightness(${1+w*.3})`})}else{let v=g*1.6-.3,w=x/f.length,S=Math.abs(v-w),I=S<.3?1-S/.3:0,E=Math.round(100+I*800);p(b,{fontWeight:E.toString(),opacity:"1"})}}),e.rafId=requestAnimationFrame(m)};m(),e.animated=!0;return}let c=()=>{let f=performance.now(),y=Math.max(0,f-r),m=Math.min(y/t.duration,1),u=l(m);if(a&&i){let g=i.value*u;a.textContent=m>=1?i.original:q(g,i.original,i.decimals)}if(o){let g=!0;o.forEach((b,x)=>{let v=x*t.splitDelay,w=y-v;if(w<0){g=!1;return}let S=Math.min(w/t.duration,1),I=l(S),[E,j]=D(d.animation||t.animation,d.direction||t.direction,I);p(b,{opacity:E,transform:j!=="none"?j:"",filter:t.blur&&I<1?`blur(${(1-I)*10}px)`:""}),S<1&&(g=!1)}),g?(n.animating.delete(s),e.animated=!0,s.setAttribute("data-usal-animated","1")):e.rafId=requestAnimationFrame(c)}else{let[g,b]=D(t.animation,t.direction,u);p(s,{opacity:g,transform:b!=="none"?b:"",filter:t.blur&&u<1?`blur(${(1-u)*10}px)`:""}),m<1?e.rafId=requestAnimationFrame(c):(n.animating.delete(s),e.animated=!0,s.setAttribute("data-usal-animated","1"))}};e.rafId=requestAnimationFrame(c)},L=(e,n)=>{e.rafId&&(cancelAnimationFrame(e.rafId),e.rafId=null);let{element:t,original:s,targets:o,config:a,countSpan:i}=e;if(!a.text&&!i&&!o){let[r,l]=D(a.animation,a.direction,0);p(t,{opacity:"0",transform:l!=="none"?l:"",filter:a.blur?"blur(10px)":""})}else p(t,s);if(i&&(i.textContent="0"),o){let[,r]=D(a.animation,a.direction,0);o.forEach(l=>p(l,{opacity:"0",transform:r!=="none"?r:"",filter:a.blur?"blur(10px)":""}))}e.animated=!1,t.removeAttribute("data-usal-animated"),n.animating.delete(t)},T=e=>{let n=new Set;document.querySelectorAll("[data-usal]").forEach(t=>{let s=t.getAttribute("data-usal-id"),o=t.getAttribute("data-usal");if(s&&e.elements.has(s)){n.add(s);let a=e.elements.get(s);if(o!==a.configString){L(a,e),e.elements.delete(s);let i=P(t,e);e.observer&&e.observer.observe(t),N(t)&&O(i,e)}}else{let a=P(t,e),i=a.element.getAttribute("data-usal-id");n.add(i),e.observer&&e.observer.observe(t),N(t)&&O(a,e)}}),e.elements.forEach((t,s)=>{n.has(s)||(t.rafId&&cancelAnimationFrame(t.rafId),e.observer&&e.observer.unobserve(t.element),e.elements.delete(s))})},W=e=>{e.observer&&e.observer.disconnect();let n=new Set([0]);e.elements.forEach(t=>{let s=(t.config.threshold||e.config.defaultThreshold)/100;n.add(s)}),e.observer=new IntersectionObserver(t=>{t.forEach(s=>{let o=e.elements.get(s.target.getAttribute("data-usal-id"));if(!o)return;let a=(o.config.threshold||e.config.defaultThreshold)/100;s.intersectionRatio>=a&&!o.animated?O(o,e):s.intersectionRatio===0&&o.animated&&!o.config.once&&L(o,e)})},{threshold:Array.from(n).sort((t,s)=>t-s)}),e.elements.forEach(t=>e.observer.observe(t.element)),e.mutationObserver&&e.mutationObserver.disconnect(),e.mutationObserver=new MutationObserver(()=>requestAnimationFrame(()=>T(e))),e.mutationObserver.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-usal"]})},F=(e={})=>{let n={observer:null,mutationObserver:null,elements:new Map,animating:new Set,config:{maxConcurrent:100,defaultDuration:1e3,defaultDelay:0,defaultThreshold:30,defaultSplitDelay:30,...e}};return{init(t={}){Object.assign(n.config,t),T(n),W(n)},destroy(){[n.observer,n.mutationObserver].forEach(t=>t?.disconnect()),n.elements.forEach(t=>{t.rafId&&cancelAnimationFrame(t.rafId),p(t.element,t.original)}),n.elements.clear(),n.animating.clear()},refresh(){T(n)},createInstance:()=>F(e)}};return{...F(),createInstance:F}})();typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>M.init()):M.init(),window.USAL=M);var X=M;return V(Y);})();
//# sourceMappingURL=usal.umd.min.js.map
